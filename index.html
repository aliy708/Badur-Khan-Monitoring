<!doctype html>
<html lang="id" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Badur Khan - Monitoring Beladiri Santri</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Amiri:wght@400;700&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #059669;
      --primary-dark: #064e3b;
      --accent: #fbbf24;
    }
    body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #1e293b; -webkit-font-smoothing: antialiased; }
    .font-arabic { font-family: 'Amiri', serif; }
    .font-certificate { font-family: 'Playfair Display', serif; }
    
    /* Animations */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fadeInUp { animation: fadeInUp 0.5s ease-out forwards; }
    
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

    /* Sidebar Smoothness */
    #sidebar { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
    .sidebar-active { transform: translateX(100%); }

    /* Modern Card Glassmorphism */
    .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); }
    
    /* Certificate Styling */
    .certificate-container { background: #fffcf0; border: 20px double #d4af37; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); }
  </style>
</head>
<body class="h-full">
  <div id="app-container" class="min-h-screen">

    <div id="login-page" class="min-h-screen flex items-center justify-center p-6 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] bg-emerald-50/50">
      <div class="w-full max-w-md">
        <div class="mb-8 p-6 glass-card rounded-[2rem] shadow-xl text-center border-emerald-100">
          <p id="current-day-login" class="text-emerald-700 font-bold uppercase tracking-widest text-xs mb-1">-</p>
          <p id="current-date-login" class="text-slate-500 font-medium text-sm mb-2">-</p>
          <p id="current-time-login" class="text-4xl font-extrabold text-emerald-900 tabular-nums">00:00:00</p>
        </div>

        <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl border border-slate-100 text-center relative overflow-hidden">
          <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-emerald-500 via-amber-400 to-emerald-500"></div>
          <div class="inline-flex p-4 rounded-3xl bg-emerald-50 mb-6 animate-float">
            <img src="https://i.ibb.co.com/ZRGH2R6Y/9am9pm-3.png" class="w-20 h-20 object-contain" alt="Logo">
          </div>
          <h1 class="text-3xl font-extrabold text-slate-800 tracking-tighter">Badur Khan</h1>
          <p class="text-slate-400 font-medium mb-8 text-sm uppercase tracking-widest">Wali Santri Portal</p>
          
          <form id="login-form" class="space-y-4">
            <div class="relative group">
              <input type="text" id="niath-input" placeholder="MASUKKAN NIATH" class="w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:border-emerald-500 focus:bg-white outline-none uppercase font-bold text-center transition-all group-hover:border-slate-200">
            </div>
            <button type="submit" class="w-full py-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-2xl shadow-lg shadow-emerald-200 transition-all active:scale-[0.98]">
              MASUK KE SISTEM
            </button>
          </form>
          <p id="error-msg" class="text-red-500 text-xs font-bold mt-4 hidden bg-red-50 p-2 rounded-lg">Maaf, NIATH tidak terdaftar!</p>
        </div>
      </div>
    </div>

    <div id="dashboard-page" class="hidden min-h-screen">
      <div id="sidebar-overlay" class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[90] hidden" onclick="toggleSidebar()"></div>
      <aside id="sidebar" class="fixed top-0 -left-[300px] w-[300px] h-full bg-white z-[100] shadow-2xl flex flex-col p-8">
        <div class="flex items-center gap-3 mb-10 pb-6 border-b">
          <img src="https://i.ibb.co.com/ZRGH2R6Y/9am9pm-3.png" class="w-10 h-10 object-contain">
          <h2 class="text-xl font-extrabold text-emerald-900 italic">Badur Khan</h2>
        </div>
        <nav class="space-y-2 flex-1">
          <button onclick="navTo('dashboard')" class="nav-btn active w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üè† Dashboard</button>
          <button onclick="navTo('biodata')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üë§ Biodata</button>
          <button onclick="navTo('struktur')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Struktur</button>
          <button onclick="navTo('program')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üìù Target</button>
          <button onclick="navTo('dokumentasi')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üì∏ Galeri</button>
          <button onclick="navTo('iuran')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all">üí∞ Iuran</button>
          <button onclick="navTo('sertifikat')" class="nav-btn w-full flex items-center gap-4 p-4 rounded-2xl hover:bg-emerald-50 text-slate-600 font-semibold transition-all text-emerald-600">üìú Sertifikat</button>
        </nav>
        <button onclick="location.reload()" class="mt-auto w-full p-4 bg-red-50 text-red-600 rounded-2xl font-bold hover:bg-red-100 transition">KELUAR PORTAL</button>
      </aside>

      <header class="max-w-6xl mx-auto px-6 py-4 sticky top-0 z-40">
        <div class="glass-card rounded-[1.5rem] p-4 flex justify-between items-center shadow-lg shadow-slate-200/50">
          <div class="flex items-center gap-4">
            <button onclick="toggleSidebar()" class="w-12 h-12 flex items-center justify-center bg-emerald-600 text-white rounded-2xl shadow-md shadow-emerald-100 font-bold">‚ò∞</button>
            <div class="hidden sm:flex items-center gap-3 border-l pl-4">
              <img src="https://i.ibb.co.com/ZRGH2R6Y/9am9pm-3.png" class="w-8 h-8 object-contain">
              <div>
                <p class="text-xs font-black text-emerald-900 uppercase leading-none">Badur Khan</p>
                <p class="text-[9px] text-slate-400 font-bold italic tracking-tighter">Monitoring System</p>
              </div>
            </div>
          </div>
          <div class="text-center">
            <p id="header-clock" class="text-lg font-black text-emerald-900 leading-none tabular-nums">00:00:00</p>
            <p id="header-date" class="text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-1"></p>
          </div>
          <div class="text-right leading-none bg-emerald-50 px-4 py-2 rounded-xl hidden md:block">
            <p id="academic-year" class="text-xs font-black text-emerald-800 mb-0.5"></p>
            <p id="academic-semester" class="text-[10px] font-bold text-emerald-600/70 italic"></p>
          </div>
        </div>
      </header>

      <main class="p-6 max-w-6xl mx-auto pb-20">
        
        <div id="content-dashboard" class="content-section space-y-8">
          <div class="bg-gradient-to-br from-emerald-800 to-emerald-950 p-10 rounded-[3rem] text-white shadow-2xl relative overflow-hidden">
            <div class="absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -mr-20 -mt-20"></div>
            <div class="relative z-10">
              <h2 class="text-lg font-medium opacity-80 mb-1">Ahlan wa Sahlan,</h2>
              <p class="text-5xl font-extrabold text-amber-300 tracking-tighter mb-4" id="display-nama">-</p>
              <div class="inline-flex px-4 py-2 bg-white/10 rounded-xl text-xs font-bold tracking-widest uppercase" id="display-niath">NIATH: -</div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white p-8 rounded-[2rem] shadow-sm border-b-8 border-emerald-500 transition-transform hover:-translate-y-2">
              <p class="text-xs font-black text-slate-400 uppercase mb-2">Total Kehadiran</p>
              <p id="stat-hadir" class="text-5xl font-black text-emerald-600">0</p>
            </div>
            <div class="bg-white p-8 rounded-[2rem] shadow-sm border-b-8 border-amber-400 transition-transform hover:-translate-y-2">
              <p class="text-xs font-black text-slate-400 uppercase mb-2">Izin / Sakit</p>
              <p id="stat-sakit" class="text-5xl font-black text-amber-500">0</p>
            </div>
            <div class="bg-white p-8 rounded-[2rem] shadow-sm border-b-8 border-red-500 transition-transform hover:-translate-y-2">
              <p class="text-xs font-black text-slate-400 uppercase mb-2">Tanpa Keterangan</p>
              <p id="stat-alpa" class="text-5xl font-black text-red-500">0</p>
            </div>
          </div>

          <div class="bg-white p-10 rounded-[3rem] shadow-sm border border-slate-100">
            <h3 class="text-2xl font-extrabold text-emerald-950 mb-8 flex items-center gap-3">
              <span class="w-10 h-10 flex items-center justify-center bg-emerald-100 rounded-xl text-lg">üìú</span>
              Sejarah Thifan Po Khan
            </h3>
            <div class="text-slate-600 text-sm leading-loose space-y-6 text-justify italic">
              <p>Sejarah <strong>Thifan Po Khan</strong> berakar pada ekspansi Islam ke Asia Tengah pasca-Pertempuran Qadisiyyah (636 M), yang memicu transformasi bela diri lokal di Turkistan Timur (Xinjiang) dari Kungfu Utara Budha menjadi Muslim melalui proses islamisasi oleh suku-suku Turki. Evolusi keilmuan ini mencapai puncaknya pada abad ke-13 melalui Master Je‚Äônan yang mensintesis berbagai teknik gulat Mongol, Tartar, hingga perkelahian Shaolin menjadi aliran Shurulkhan, sebelum akhirnya disatukan kembali oleh Ahmad Syiharani menjadi Thifan Po Khan yang terdokumentasi dalam Kitab Zhodam.</p>
              <p>Di era modern, Thifan Po Khan dikonsolidasikan oleh <strong>Ustadz Ahmad Eldin Marzdedeq</strong> dan kini diteruskan oleh para penerusnya seperti <strong>Ustadz Pupu</strong> sebagai warisan bela diri yang mengintegrasikan kekuatan fisik dengan nilai-nilai Tauhid dan Sunnah.</p>
            </div>
          </div>
        </div>

        <div id="content-biodata" class="content-section hidden">
          <div class="bg-white p-10 rounded-[3rem] shadow-sm border border-slate-100">
            <h3 class="text-2xl font-extrabold text-emerald-950 mb-8 text-center uppercase tracking-widest">Data Akademik Santri</h3>
            <div class="max-w-2xl mx-auto space-y-4">
              <div class="flex justify-between p-4 bg-slate-50 rounded-2xl"><span class="font-bold text-slate-500">Nama Lengkap</span><span id="bio-nama" class="font-extrabold text-emerald-900">-</span></div>
              <div class="flex justify-between p-4 bg-white rounded-2xl border"><span class="font-bold text-slate-500">Usia</span><span id="bio-umur" class="font-extrabold text-slate-800">-</span></div>
              <div class="flex justify-between p-4 bg-slate-50 rounded-2xl"><span class="font-bold text-slate-500">Kelas</span><span id="bio-kelas" class="font-extrabold text-slate-800">-</span></div>
              <div class="flex justify-between p-4 bg-white rounded-2xl border"><span class="font-bold text-slate-500">Tingkat Sabuk</span><span id="bio-tingkat" class="font-extrabold text-emerald-600">-</span></div>
              <div class="p-6 bg-slate-900 rounded-[2rem] mt-6 text-white text-center">
                <p class="text-[10px] uppercase font-bold text-slate-400 mb-1">Domisili Tercatat</p>
                <p id="bio-alamat" class="text-sm font-medium">-</p>
              </div>
            </div>
          </div>
        </div>

        <div id="content-dokumentasi" class="content-section hidden">
          <div class="bg-white p-10 rounded-[3rem] shadow-sm border border-slate-100">
            <h3 class="text-2xl font-extrabold text-emerald-950 mb-10 text-center uppercase tracking-tighter">üì∏ Aktivitas Terbaru</h3>
            <div id="dynamic-docs" class="mb-10">
              <div class="text-center py-20 bg-slate-50 rounded-[2.5rem] border-2 border-dashed border-slate-200">
                <p class="text-slate-400 text-xs italic font-bold">Menunggu sinkronisasi data dari Pelatih...</p>
              </div>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
              <div class="group cursor-pointer">
                <div class="w-full aspect-square bg-emerald-50 rounded-[2rem] flex items-center justify-center text-3xl mb-3 group-hover:bg-emerald-600 group-hover:text-white transition-all shadow-sm">ü•ã</div>
                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Rutin</p>
              </div>
              <div class="group cursor-pointer">
                <div class="w-full aspect-square bg-amber-50 rounded-[2rem] flex items-center justify-center text-3xl mb-3 group-hover:bg-amber-500 group-hover:text-white transition-all shadow-sm">üìπ</div>
                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Edukasi</p>
              </div>
              <div class="group cursor-pointer">
                <div class="w-full aspect-square bg-blue-50 rounded-[2rem] flex items-center justify-center text-3xl mb-3 group-hover:bg-blue-600 group-hover:text-white transition-all shadow-sm">üìú</div>
                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Ujian</p>
              </div>
              <div class="group cursor-pointer">
                <div class="w-full aspect-square bg-red-50 rounded-[2rem] flex items-center justify-center text-3xl mb-3 group-hover:bg-red-600 group-hover:text-white transition-all shadow-sm">üèÜ</div>
                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Event</p>
              </div>
            </div>
          </div>
        </div>

        <div id="content-iuran" class="content-section hidden">
          <div class="bg-white p-12 rounded-[3rem] shadow-sm border border-slate-100 text-center">
            <h3 class="text-3xl font-black text-emerald-950 mb-10 tracking-tight">Status Finansial</h3>
            <div class="max-w-md mx-auto p-10 bg-emerald-50 rounded-[3rem] border border-emerald-100 shadow-inner">
              <p class="text-xs text-emerald-600 font-black uppercase mb-4 tracking-widest">Informasi Pembayaran</p>
              <p id="display-iuran" class="text-5xl font-black text-emerald-800 italic uppercase">LUNAS</p>
            </div>
            <p class="mt-10 text-slate-400 text-xs font-medium italic">*Data disinkronkan secara otomatis oleh Bendahara Thifan Badur Khan.</p>
          </div>
        </div>

        <div id="content-sertifikat" class="content-section hidden space-y-10">
          <div id="cert-area" class="certificate-container p-16 max-w-3xl mx-auto aspect-[4/3] flex flex-col justify-between text-center relative">
            <div class="certificate-border"></div>
            <div class="relative z-10">
              <img src="https://i.ibb.co.com/ZRGH2R6Y/9am9pm-3.png" class="w-20 mx-auto mb-8 opacity-40">
              <h2 class="font-certificate text-4xl text-amber-900 font-bold mb-8 italic tracking-wider">Sertifikat Kelulusan</h2>
              <p class="text-slate-500 text-sm font-medium italic mb-2">Dengan penuh kehormatan diberikan kepada:</p>
              <h3 id="cert-nama" class="font-certificate text-4xl font-bold text-emerald-950 my-6 border-b-2 border-amber-300 inline-block px-10">-</h3>
              <p class="text-slate-600 text-sm font-medium mt-6 tracking-wide">Telah memenuhi standar kualifikasi pada tingkat:</p>
              <p id="cert-tingkat" class="text-emerald-700 font-black text-3xl my-4 uppercase tracking-widest">-</p>
            </div>
            <div class="relative z-10 flex justify-center mt-12">
              <div class="text-center">
                <p class="text-slate-400 text-[10px] font-bold mb-16 uppercase tracking-[0.2em]">Pembina Badur Khan</p>
                <div class="border-b border-emerald-950 w-64 mx-auto mb-1"></div>
                <span class="text-emerald-950 font-black uppercase text-sm tracking-widest">Ust. Ali Yahya, B.A.</span>
              </div>
            </div>
          </div>
          <button onclick="downloadPDF()" class="w-full max-w-md mx-auto block py-5 bg-slate-900 hover:bg-black text-white font-black rounded-3xl shadow-2xl transition-all uppercase tracking-widest text-sm">üì• Unduh PDF</button>
        </div>

        <div id="content-program" class="content-section hidden">
          <div class="bg-white p-10 rounded-[3rem] shadow-sm border border-slate-100">
             <h3 class="text-2xl font-extrabold text-emerald-950 mb-8 text-center italic">Kurikulum & Target Latihan</h3>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 text-sm">
               <div class="bg-emerald-50 p-6 rounded-3xl border border-emerald-100">
                 <h4 class="font-black text-emerald-800 mb-4 uppercase">Program Tahunan</h4>
                 <ul class="space-y-3 font-medium text-emerald-900/70">
                   <li>‚Ä¢ Ujian Kenaikan Tingkat (UKT)</li>
                   <li>‚Ä¢ Pertandingan Tahunan</li>
                 </ul>
               </div>
               <div class="bg-amber-50 p-6 rounded-3xl border border-amber-100">
                 <h4 class="font-black text-amber-800 mb-4 uppercase">Program Semesteran</h4>
                 <ul class="space-y-3 font-medium text-amber-900/70">
                   <li>‚Ä¢ Uji Kompetensi Berkala</li>
                   <li>‚Ä¢ Fun Match & Gathering</li>
                 </ul>
               </div>
             </div>
          </div>
        </div>

        <div id="content-struktur" class="content-section hidden">
           <div class="bg-white p-10 rounded-[3rem] shadow-sm border border-slate-100 overflow-x-auto">
             <h3 class="text-2xl font-black text-emerald-950 mb-10 text-center uppercase">Struktur Kepengurusan</h3>
             <div class="org-chart min-w-[600px]">
               <div class="org-level"><div class="org-box">Pembina: Ust. Ali Yahya, B.A.</div></div>
               <div class="org-level">
                 <div class="org-box bg-amber-600">Ketua: M. Nikhat Al-Badruni</div>
                 <div class="org-box bg-amber-500">Wakil: Ahmad Jariir</div>
               </div>
               </div>
           </div>
        </div>

      </main>
    </div>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby1dhtnEwxYiGPD-pyLSTc_iqTukm6ruyoiZ20SDxPajs_7cvw3EwoOAqY2TPRPX7Svrw/exec';

    function updateClock() {
      const now = new Date();
      const timeStr = now.toLocaleTimeString('id-ID', { hour12: false });
      const dayStr = now.toLocaleDateString('id-ID', { weekday: 'long' });
      const dateStr = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
      
      const elements = {
        'current-time-login': timeStr,
        'current-day-login': dayStr,
        'current-date-login': dateStr,
        'header-clock': timeStr,
        'header-date': dateStr
      };

      for (const [id, val] of Object.entries(elements)) {
        const el = document.getElementById(id);
        if(el) el.innerText = val;
      }

      const month = now.getMonth() + 1;
      const year = now.getFullYear();
      let academicYearStr = (month >= 7) ? `${year}/${year + 1}` : `${year - 1}/${year}`;
      let semesterStr = (month >= 7 && month <= 12) ? "Semester Ganjil" : "Semester Genap";
      
      if(document.getElementById('academic-year')) document.getElementById('academic-year').innerText = academicYearStr;
      if(document.getElementById('academic-semester')) document.getElementById('academic-semester').innerText = semesterStr;
    }
    setInterval(updateClock, 1000);
    updateClock();

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('sidebar-active');
      document.getElementById('sidebar-overlay').classList.toggle('hidden');
      // Fix for mobile sidebar sliding from left
      const sidebar = document.getElementById('sidebar');
      if (sidebar.style.left === '0px') {
          sidebar.style.left = '-300px';
      } else {
          sidebar.style.left = '0px';
      }
    }

    function navTo(section) {
      document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
      document.getElementById(`content-${section}`).classList.remove('hidden');
      
      // Update Active Button UI
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.remove('bg-emerald-600', 'text-white');
        if(btn.innerText.toLowerCase().includes(section)) {
          btn.classList.add('bg-emerald-600', 'text-white');
        }
      });

      if(window.innerWidth < 1024) toggleSidebar();
    }

    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const niath = document.getElementById('niath-input').value.trim();
      if(!niath) return;
      const btn = e.target.querySelector('button');
      btn.innerText = "MENGAMBIL DATA..."; btn.disabled = true;

      const callbackName = 'jsonp_cb_' + Math.floor(Math.random() * 1000000);
      window[callbackName] = function(data) {
        delete window[callbackName];
        const oldScripts = document.querySelectorAll('script[data-type="jsonp"]');
        oldScripts.forEach(s => s.remove());
        
        if(data.error) {
          document.getElementById('error-msg').classList.remove('hidden');
          btn.innerText = "MASUK SISTEM"; btn.disabled = false;
        } else {
          populateDashboard(data);
          document.getElementById('login-page').classList.add('hidden');
          document.getElementById('dashboard-page').classList.remove('hidden');
        }
      };
      const scriptTag = document.createElement('script');
      scriptTag.src = `${SCRIPT_URL}?niath=${niath}&callback=${callbackName}`;
      scriptTag.setAttribute('data-type', 'jsonp');
      document.head.appendChild(scriptTag);
    });

    function populateDashboard(d) {
      // Identity
      document.getElementById('display-nama').innerText = d.nama;
      document.getElementById('display-niath').innerText = `NIATH: ${d.niath}`;
      
      // Stats
      document.getElementById('stat-hadir').innerText = d.kehadiran || 0;
      document.getElementById('stat-sakit').innerText = d.sakit || 0;
      document.getElementById('stat-alpa').innerText = d.alpa || 0;
      
      // Iuran
      let statusIuran = d.iuran ? d.iuran.toString().replace(/\"/g, "") : "LUNAS";
      document.getElementById('display-iuran').innerText = statusIuran;
      
      // Profile details
      document.getElementById('bio-nama').innerText = d.nama;
      document.getElementById('bio-umur').innerText = `${d.umur || '-'} Tahun`;
      document.getElementById('bio-kelas').innerText = d.kelas || "-"; 
      document.getElementById('bio-tingkat').innerText = d.tingkat || "-";
      document.getElementById('bio-alamat').innerText = d.alamat || "Alamat belum diperbarui";
      
      // Certifications
      document.getElementById('cert-nama').innerText = d.nama;
      document.getElementById('cert-tingkat').innerText = d.tingkat || "SANTRI";

      // Galery Injection
      const dynamicDocs = document.getElementById('dynamic-docs');
      if (dynamicDocs && (d.foto_lat || d.video_lat)) {
        dynamicDocs.innerHTML = `
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8 animate-fadeInUp">
            ${d.foto_lat ? `
              <div class="space-y-4">
                <p class="text-[10px] font-black text-emerald-600 uppercase tracking-widest text-center">Snapshot Kegiatan</p>
                <div class="rounded-[2.5rem] overflow-hidden shadow-2xl border-4 border-white aspect-video">
                  <img src="${d.foto_lat}" class="w-full h-full object-cover">
                </div>
              </div>` : ''}
            ${d.video_lat ? `
              <div class="space-y-4">
                <p class="text-[10px] font-black text-amber-600 uppercase tracking-widest text-center">Rekaman Latihan</p>
                <div class="rounded-[2.5rem] overflow-hidden shadow-2xl border-4 border-white bg-black aspect-video">
                  <video controls class="w-full h-full"><source src="${d.video_lat}" type="video/mp4"></video>
                </div>
              </div>` : ''}
          </div>`;
      }
    }

    async function downloadPDF() {
      const area = document.getElementById('cert-area');
      const canvas = await html2canvas(area, { scale: 3, useCORS: true });
      const imgData = canvas.toDataURL('image/png');
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('l', 'mm', 'a4');
      pdf.addImage(imgData, 'PNG', 10, 10, 277, 190);
      pdf.save(`Sertifikat-BadurKhan-${document.getElementById('cert-nama').innerText}.pdf`);
    }
  </script>
</body>
</html>
